{"ast":null,"code":"var _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect, useReducer, memo, useMemo, useCallback } from 'react';\n\nfunction countReducer(state, action) {\n  switch (action.type) {\n    case 'add':\n      return state + 1;\n\n    case 'minus':\n      return state - 1;\n\n    default:\n      return state;\n  }\n}\n\nfunction MyCountFun() {\n  _s();\n\n  // const [count,setCount]=useState(0)\n  var _useReducer = useReducer(countReducer, 0),\n      count = _useReducer[0],\n      dispatchCount = _useReducer[1];\n\n  var _useState = useState('majy'),\n      name = _useState[0],\n      setName = _useState[1]; // useEffect(()=>{\n  // \tlet interval = setInterval(()=>{\n  // \t\tdispatchCount({type:'minus'})\n  // \t\t// setCount(count=>count+1)\n  // \t},1000)\n  // \treturn ()=>clearInterval(interval)\n  // },[])\n  //dom更新到节点之后 useLayoutEffect更新之前\n\n\n  useEffect(function () {\n    console.log(\"useEffect init\");\n    return function () {\n      console.log(\"useEffect detach\");\n    };\n  }, [name]); // 传入的值有变化才会重新执行useEffect里的事情\n  // 优化前\n  // const config = {\n  // \ttext:`count is ${count}`,\n  // \tcolor:count>3?'red':'blue'\n  // }\n  // 优化后\n\n  var config = useMemo(function () {\n    return {\n      text: \"count is \".concat(count),\n      color: count > 3 ? 'red' : 'blue'\n    };\n  }, [count]);\n  var handleButtonClick = useCallback(function () {\n    return dispatchCount({\n      type: 'add'\n    });\n  });\n  return __jsx(\"div\", null, __jsx(\"input\", {\n    value: name,\n    onChange: function onChange(e) {\n      return setName(e.target.value);\n    }\n  }), __jsx(\"button\", {\n    onClick: function onClick() {\n      return dispatchCount({\n        type: 'minus'\n      });\n    }\n  }, count), __jsx(Child, {\n    config: config,\n    onButtonClick: handleButtonClick\n  }));\n} // 每次传入参数变化都要重新渲染，担忧的变化和该组件无关，应该有话\n\n\n_s(MyCountFun, \"StQsneuyunrmp3y3+Aw4M0oS008=\");\n\n_c = MyCountFun;\nvar Child = memo(_c2 = function Child(_ref) {\n  var onButtonClick = _ref.onButtonClick,\n      config = _ref.config;\n  console.log('child render');\n  return __jsx(\"button\", {\n    onClick: onButtonClick,\n    style: {\n      color: config.color\n    }\n  }, config.text);\n});\n_c3 = Child;\nexport default MyCountFun;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"MyCountFun\");\n$RefreshReg$(_c2, \"Child$memo\");\n$RefreshReg$(_c3, \"Child\");","map":{"version":3,"sources":["/Users/majy/study/next-app/pages/hook.js"],"names":["React","useState","useEffect","useReducer","memo","useMemo","useCallback","countReducer","state","action","type","MyCountFun","count","dispatchCount","name","setName","console","log","config","text","color","handleButtonClick","e","target","value","Child","onButtonClick"],"mappings":";;;AAAA,OAAOA,KAAP,IAAcC,QAAd,EAAwBC,SAAxB,EAAmCC,UAAnC,EAA+CC,IAA/C,EAAqDC,OAArD,EAA8DC,WAA9D,QAAgF,OAAhF;;AAGA,SAASC,YAAT,CAAsBC,KAAtB,EAA4BC,MAA5B,EAAmC;AAClC,UAAOA,MAAM,CAACC,IAAd;AACC,SAAK,KAAL;AACI,aAAOF,KAAK,GAAC,CAAb;;AACJ,SAAK,OAAL;AACC,aAAOA,KAAK,GAAC,CAAb;;AACD;AACC,aAAOA,KAAP;AANF;AAQA;;AAED,SAASG,UAAT,GAAqB;AAAA;;AACpB;AADoB,oBAESR,UAAU,CAACI,YAAD,EAAc,CAAd,CAFnB;AAAA,MAEbK,KAFa;AAAA,MAENC,aAFM;;AAAA,kBAGCZ,QAAQ,CAAC,MAAD,CAHT;AAAA,MAGba,IAHa;AAAA,MAGRC,OAHQ,iBAIpB;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;AACAb,EAAAA,SAAS,CAAC,YAAI;AACbc,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACA,WAAO,YAAI;AACVD,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACA,KAFD;AAGA,GALQ,EAKP,CAACH,IAAD,CALO,CAAT,CAboB,CAkBX;AACT;AACG;AACA;AACA;AACA;AACA;;AACA,MAAMI,MAAM,GAAGb,OAAO,CAAC;AAAA,WAAK;AAC3Bc,MAAAA,IAAI,qBAAaP,KAAb,CADuB;AAE3BQ,MAAAA,KAAK,EAACR,KAAK,GAAC,CAAN,GAAQ,KAAR,GAAc;AAFO,KAAL;AAAA,GAAD,EAGnB,CAACA,KAAD,CAHmB,CAAtB;AAKA,MAAMS,iBAAiB,GAAGf,WAAW,CAAC;AAAA,WAAIO,aAAa,CAAC;AAACH,MAAAA,IAAI,EAAC;AAAN,KAAD,CAAjB;AAAA,GAAD,CAArC;AAEH,SACC,mBACC;AAAO,IAAA,KAAK,EAAEI,IAAd;AAAoB,IAAA,QAAQ,EAAE,kBAAAQ,CAAC;AAAA,aAAEP,OAAO,CAACO,CAAC,CAACC,MAAF,CAASC,KAAV,CAAT;AAAA;AAA/B,IADD,EAEC;AAAQ,IAAA,OAAO,EAAE;AAAA,aAAIX,aAAa,CAAC;AAACH,QAAAA,IAAI,EAAC;AAAN,OAAD,CAAjB;AAAA;AAAjB,KAAqDE,KAArD,CAFD,EAGC,MAAC,KAAD;AAAO,IAAA,MAAM,EAAEM,MAAf;AAAuB,IAAA,aAAa,EAAEG;AAAtC,IAHD,CADD;AAOA,C,CACD;;;GAxCSV,U;;KAAAA,U;AAyCT,IAAMc,KAAK,GAAGrB,IAAI,OAAC,SAASqB,KAAT,OAAsC;AAAA,MAAtBC,aAAsB,QAAtBA,aAAsB;AAAA,MAARR,MAAQ,QAARA,MAAQ;AACxDF,EAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;AACA,SACC;AAAQ,IAAA,OAAO,EAAES,aAAjB;AAAgC,IAAA,KAAK,EAAE;AAACN,MAAAA,KAAK,EAAEF,MAAM,CAACE;AAAf;AAAvC,KAA+DF,MAAM,CAACC,IAAtE,CADD;AAGA,CALiB,CAAlB;MAAMM,K;AAON,eAAed,UAAf","sourcesContent":["import React,{useState, useEffect, useReducer, memo, useMemo, useCallback} from 'react'\n\n\nfunction countReducer(state,action){\n\tswitch(action.type){\n\t\tcase 'add':\n\t\t    return state+1\n\t\tcase 'minus':\n\t\t\treturn state-1\n\t\tdefault:\n\t\t\treturn state    \n\t}\n}\n\nfunction MyCountFun(){\n\t// const [count,setCount]=useState(0)\n\tconst [count, dispatchCount]=useReducer(countReducer,0)\n\tconst [name,setName]=useState('majy')\n\t// useEffect(()=>{\n\t// \tlet interval = setInterval(()=>{\n\t// \t\tdispatchCount({type:'minus'})\n\t// \t\t// setCount(count=>count+1)\n\t// \t},1000)\n\n\t// \treturn ()=>clearInterval(interval)\n\t// },[])\n\t//dom更新到节点之后 useLayoutEffect更新之前\n\tuseEffect(()=>{\n\t\tconsole.log(\"useEffect init\")\n\t\treturn ()=>{\n\t\t\tconsole.log(\"useEffect detach\")\n\t\t}\n\t},[name])// 传入的值有变化才会重新执行useEffect里的事情\n\t// 优化前\n    // const config = {\n    // \ttext:`count is ${count}`,\n    // \tcolor:count>3?'red':'blue'\n    // }\n    // 优化后\n    const config = useMemo(()=>({\n    \ttext:`count is ${count}`,\n    \tcolor:count>3?'red':'blue'\n    }),[count])\n\n    const handleButtonClick = useCallback(()=>dispatchCount({type:'add'}))\n\n\treturn (\n\t\t<div>\n\t\t\t<input value={name} onChange={e=>setName(e.target.value)}/>\n\t\t\t<button onClick={()=>dispatchCount({type:'minus'})}>{count}</button>\n\t\t\t<Child config={config} onButtonClick={handleButtonClick}/>\n\t\t</div>\n\t)\n}\n// 每次传入参数变化都要重新渲染，担忧的变化和该组件无关，应该有话\nconst Child = memo(function Child({onButtonClick,config}){\n\tconsole.log('child render')\n\treturn (\n\t\t<button onClick={onButtonClick} style={{color: config.color}}>{config.text}</button>\n\t)\n})\n\nexport default MyCountFun"]},"metadata":{},"sourceType":"module"}