{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { createStore, combineReducers, applyMiddleware } from 'redux';\nimport ReduxThunk from 'redux-thunk';\nconst initialState = {\n  count: 0\n};\nconst userInitialState = {\n  username: 'majy',\n  age: 30\n};\nconst ADD = 'add';\nconst UPDATE_USER = \"UPDATE_USER\"; // 纯函数，没有副作用\n// 有任何更新都要返回新的对象\n// 可以通过 combineReducers合并\n\nfunction countReducer(state = initialState, action) {\n  console.log(state, action);\n\n  switch (action.type) {\n    case ADD:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        count: state.count + (action.num || 1)\n      });\n\n    default:\n      return state;\n  }\n}\n\nfunction userReducer(state = userInitialState, action) {\n  console.log(state, action);\n\n  switch (action.type) {\n    case UPDATE_USER:\n      return _objectSpread(_objectSpread({}, state), {}, {\n        username: action.user\n      });\n\n    default:\n      return state;\n  }\n}\n\nconst reducer = combineReducers({\n  counter: countReducer,\n  user: userReducer\n});\nconst store = createStore(reducer, {\n  counter: initialState,\n  user: userInitialState\n}, applyMiddleware(ReduxThunk)); // action creater\n\nfunction add(num) {\n  return {\n    type: ADD,\n    num\n  };\n}\n\nfunction addAsync(num) {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(num);\n    }, 1000);\n  };\n}\n\nconsole.log(store);\nstore.subscribe(() => {\n  console.log('changed', store.getState());\n});\nstore.dispatch(add(3));\nstore.dispatch(addAsync(4));\nstore.dispatch({\n  type: 'add'\n});\nstore.dispatch({\n  type: 'UPDATE_USER',\n  user: 'ghge'\n});\nexport default store;","map":{"version":3,"sources":["/Users/majy/study/next-app/store/store.js"],"names":["createStore","combineReducers","applyMiddleware","ReduxThunk","initialState","count","userInitialState","username","age","ADD","UPDATE_USER","countReducer","state","action","console","log","type","num","userReducer","user","reducer","counter","store","add","addAsync","dispatch","setTimeout","subscribe","getState"],"mappings":";;;;;;AAAA,SAAQA,WAAR,EAAoBC,eAApB,EAAoCC,eAApC,QAA0D,OAA1D;AACA,OAAOC,UAAP,MAAuB,aAAvB;AAEA,MAAMC,YAAY,GAAG;AACpBC,EAAAA,KAAK,EAAE;AADa,CAArB;AAGA,MAAMC,gBAAgB,GAAG;AACxBC,EAAAA,QAAQ,EAAC,MADe;AAExBC,EAAAA,GAAG,EAAE;AAFmB,CAAzB;AAIA,MAAMC,GAAG,GAAG,KAAZ;AACA,MAAMC,WAAW,GAAC,aAAlB,C,CACA;AACA;AACA;;AACA,SAASC,YAAT,CAAsBC,KAAK,GAACR,YAA5B,EAAyCS,MAAzC,EAAgD;AAC/CC,EAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ,EAAkBC,MAAlB;;AACA,UAAOA,MAAM,CAACG,IAAd;AACC,SAAKP,GAAL;AACC,6CAAWG,KAAX;AAAkBP,QAAAA,KAAK,EAACO,KAAK,CAACP,KAAN,IAAaQ,MAAM,CAACI,GAAP,IAAY,CAAzB;AAAxB;;AACD;AACC,aAAOL,KAAP;AAJF;AAMA;;AACD,SAASM,WAAT,CAAqBN,KAAK,GAACN,gBAA3B,EAA4CO,MAA5C,EAAmD;AAClDC,EAAAA,OAAO,CAACC,GAAR,CAAYH,KAAZ,EAAkBC,MAAlB;;AACA,UAAOA,MAAM,CAACG,IAAd;AACC,SAAKN,WAAL;AACC,6CAAWE,KAAX;AAAkBL,QAAAA,QAAQ,EAACM,MAAM,CAACM;AAAlC;;AACD;AACC,aAAOP,KAAP;AAJF;AAMA;;AAED,MAAMQ,OAAO,GAAGnB,eAAe,CAAC;AAC/BoB,EAAAA,OAAO,EAAEV,YADsB;AAE/BQ,EAAAA,IAAI,EAAED;AAFyB,CAAD,CAA/B;AAKA,MAAMI,KAAK,GAAGtB,WAAW,CACvBoB,OADuB,EAEvB;AACCC,EAAAA,OAAO,EAAEjB,YADV;AAECe,EAAAA,IAAI,EAAEb;AAFP,CAFuB,EAMvBJ,eAAe,CAACC,UAAD,CANQ,CAAzB,C,CASA;;AACA,SAASoB,GAAT,CAAaN,GAAb,EAAiB;AAChB,SAAO;AACND,IAAAA,IAAI,EAACP,GADC;AAENQ,IAAAA;AAFM,GAAP;AAIA;;AACD,SAASO,QAAT,CAAkBP,GAAlB,EAAsB;AACrB,SAAQQ,QAAD,IAAY;AAClBC,IAAAA,UAAU,CAAC,MAAI;AACdD,MAAAA,QAAQ,CAACR,GAAD,CAAR;AACA,KAFS,EAER,IAFQ,CAAV;AAGA,GAJD;AAKA;;AAEDH,OAAO,CAACC,GAAR,CAAYO,KAAZ;AAEAA,KAAK,CAACK,SAAN,CAAgB,MAAI;AACnBb,EAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAsBO,KAAK,CAACM,QAAN,EAAtB;AACA,CAFD;AAIAN,KAAK,CAACG,QAAN,CAAeF,GAAG,CAAC,CAAD,CAAlB;AACAD,KAAK,CAACG,QAAN,CAAeD,QAAQ,CAAC,CAAD,CAAvB;AACAF,KAAK,CAACG,QAAN,CAAe;AAACT,EAAAA,IAAI,EAAC;AAAN,CAAf;AACAM,KAAK,CAACG,QAAN,CAAe;AAACT,EAAAA,IAAI,EAAC,aAAN;AAAoBG,EAAAA,IAAI,EAAC;AAAzB,CAAf;AAEA,eAAeG,KAAf","sourcesContent":["import {createStore,combineReducers,applyMiddleware} from 'redux'\nimport ReduxThunk from 'redux-thunk'\n\nconst initialState = {\n\tcount: 0\n}\nconst userInitialState = {\n\tusername:'majy',\n\tage: 30\n}\nconst ADD = 'add'\nconst UPDATE_USER=\"UPDATE_USER\"\n// 纯函数，没有副作用\n// 有任何更新都要返回新的对象\n// 可以通过 combineReducers合并\nfunction countReducer(state=initialState,action){\n\tconsole.log(state,action)\n\tswitch(action.type){\n\t\tcase ADD:\n\t\t\treturn {...state, count:state.count+(action.num||1)}\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\nfunction userReducer(state=userInitialState,action){\n\tconsole.log(state,action)\n\tswitch(action.type){\n\t\tcase UPDATE_USER:\n\t\t\treturn {...state, username:action.user}\n\t\tdefault:\n\t\t\treturn state\n\t}\n}\n\nconst reducer = combineReducers({\n\tcounter: countReducer,\n\tuser: userReducer\n})\n\nconst store = createStore(\n\t\treducer,\n\t\t{\n\t\t\tcounter: initialState,\n\t\t\tuser: userInitialState\n\t\t},\n\t\tapplyMiddleware(ReduxThunk)\n\t)\n\n// action creater\nfunction add(num){\n\treturn {\n\t\ttype:ADD,\n\t\tnum\n\t}\n}\nfunction addAsync(num){\n\treturn (dispatch)=>{\n\t\tsetTimeout(()=>{\n\t\t\tdispatch(num)\n\t\t},1000)\n\t}\n}\n\nconsole.log(store)\n\nstore.subscribe(()=>{\n\tconsole.log('changed',store.getState())\n})\n\nstore.dispatch(add(3))\nstore.dispatch(addAsync(4))\nstore.dispatch({type:'add'})\nstore.dispatch({type:'UPDATE_USER',user:'ghge'})\n\nexport default store"]},"metadata":{},"sourceType":"module"}